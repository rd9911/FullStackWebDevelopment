(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{131:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(12),i=n.n(a),s=n(20),o=n(15),u=n(175),l=n(7),j=n.n(l),b=n(10),d=n(32),h=n(17),f=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"bloglist/create-notification",notification:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"bloglist/create-notification":return t.notification;default:return e}},O=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"userLogin/set",user:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"userLogin/set":return t.user;default:return e}},g=n(25),m=n.n(g),v={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w="/api/blogs",y=null,k={getAll:function(){return m.a.get(w).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,m.a.post(w,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){y="bearer ".concat(e)},likeBlog:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=6;break}return n={headers:{Authorization:y}},e.next=4,m.a.put("".concat(w,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=6;break}return n={headers:{Authorization:y}},e.next=4,m.a.delete("".concat(w,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),commentOnBlog:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("comment"),!y){e.next=8;break}return r={headers:{Authorization:y,"Access-Control-Allow-Origin":"*"}},e.next=5,m()({method:"put",url:"".concat(w,"/").concat(n,"/comments"),headers:r,data:{comment:t}});case 5:return c=e.sent,console.log(c),e.abrupt("return",c.data);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},S=n(176),T=n(164),B=n(2),A=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(d.a)(a,2),s=i[0],u=i[1],l=Object(h.b)(),p=Object(o.f)();Object(r.useEffect)((function(){var e=!0,t=window.localStorage.getItem("loggedUserJSON");if(e&&t){var n=JSON.parse(t);l(O(n)),k.setToken(n.token)}return function(){e=!1}}),[l]);var x=function(){var e=Object(b.a)(j.a.mark((function e(t){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r={username:n,password:s},e.prev=2,e.next=5,v.login(r);case 5:a=e.sent,l(O(a)),window.localStorage.setItem("loggedUserJSON",JSON.stringify(a)),p.push("/"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),l(f("invalid username or password")),setTimeout((function(){l(f(""))}),3e3);case 16:c(""),u("");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{children:"Login"}),Object(B.jsxs)("form",{onSubmit:x,children:[Object(B.jsx)(S.a,{required:!0,label:"Username",variant:"filled",size:"small",id:"getUsername",onChange:function(e){var t=e.target;return c(t.value)}}),Object(B.jsx)("br",{}),Object(B.jsx)(S.a,{required:!0,label:"Password",variant:"filled",size:"small",type:"password",id:"getPassword",onChange:function(e){var t=e.target;return u(t.value)}}),Object(B.jsx)(T.a,{variant:"contained",color:"primary",type:"submit",id:"submitForm",children:"Submit"})]})]})},C=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.create(e);case 2:n({type:"blog/create",blog:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.likeBlog(e);case 2:n({type:"blog/like",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.deleteBlog(e);case 2:n({type:"blog/remove",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"blog/create":return e.concat(t.blog);case"blog/initialize":return t.blogs;case"blog/like":return e.map((function(e){return t.id===e.id&&(e.likes+=1),e}));case"blog/remove":return e.filter((function(e){return e.id!==t.id}));case"blog/comment":return e.map((function(e){return t.id===e.id&&e.comments.concat(t.comment),e}));default:return e}},I=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(d.a)(a,2),s=i[0],o=i[1],u=Object(r.useState)(""),l=Object(d.a)(u,2),p=l[0],O=l[1],x=Object(h.b)(),g=function(){var e=Object(b.a)(j.a.mark((function e(t){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{x(C(r={title:n,author:p,url:s,details:!1})),x(f("a new blog ".concat(r.title," by ").concat(r.author))),setTimeout((function(){x(f(""))}),3e3),c(""),O(""),o("")}catch(a){x(f(a)),setTimeout((function(){x(f(""))}),3e3)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:["Create new",Object(B.jsxs)("form",{onSubmit:g,children:["title ",Object(B.jsx)("input",{className:"title",value:n,onChange:function(e){var t=e.target;c(t.value)}}),Object(B.jsx)("br",{}),"author ",Object(B.jsx)("input",{className:"author",value:p,onChange:function(e){var t=e.target;O(t.value)}}),Object(B.jsx)("br",{}),"url ",Object(B.jsx)("input",{className:"url",value:s,onChange:function(e){var t=e.target;o(t.value)}}),Object(B.jsx)("br",{}),Object(B.jsx)("input",{type:"submit",value:"create"})]})]})},L=n(56),J=function(){var e=Object(h.c)((function(e){return e.blogs}));return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{children:"blogs"}),console.log(e),e.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(B.jsx)("li",{className:"blog",children:Object(B.jsx)(s.b,{to:"blog-list/".concat(e.id),children:e.title})},Object(L.a)())}))]})})},E=n(165),P=n(166),D=n(167),q=n(168),F=n(169),W=n(177),H=n(170),R=n(171),G=n(172),K=n(173),M=n(174),Q=n(163),V=n(83),X=n.n(V),Y=n(82),Z=n.n(Y),$=Object(E.a)({root:{"& > *":{borderBottom:"unset"}}}),_=function(e){var t=e.row,n=Object(r.useState)(!1),a=Object(d.a)(n,2),i=a[0],o=a[1],u=$();return Object(B.jsxs)(c.a.Fragment,{children:[Object(B.jsxs)(P.a,{className:u.root,children:[Object(B.jsx)(D.a,{children:Object(B.jsx)(q.a,{"aria-label":"expand row",size:"small",onClick:function(){return o(!i)},children:i?Object(B.jsx)(Z.a,{}):Object(B.jsx)(X.a,{})})}),Object(B.jsx)(D.a,{component:"th",scope:"row",children:Object(B.jsx)(s.b,{to:"/user-list/".concat(t.id),children:t.username})}),Object(B.jsx)(D.a,{align:"right",children:t.blogs.length})]}),Object(B.jsx)(P.a,{children:Object(B.jsx)(D.a,{styel:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(B.jsx)(F.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(B.jsxs)(W.a,{margin:1,children:[Object(B.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",children:"Blogs"}),Object(B.jsxs)(R.a,{size:"small","aria-label":"purchases",children:[Object(B.jsx)(G.a,{children:Object(B.jsxs)(P.a,{children:[Object(B.jsx)(D.a,{children:"Title"}),Object(B.jsx)(D.a,{align:"right",children:"Author"}),Object(B.jsx)(D.a,{align:"right",children:"Url"})]})}),Object(B.jsx)(K.a,{children:t.blogs.map((function(e){return Object(B.jsxs)(P.a,{children:[Object(B.jsx)(D.a,{component:"th",scope:"row",children:e.title}),Object(B.jsx)(D.a,{align:"right",children:e.author}),Object(B.jsx)(D.a,{align:"right",children:e.url})]},e.id)}))})]})]})})})})]})},ee=function(e){return Object(B.jsx)(M.a,{component:Q.a,children:Object(B.jsxs)(R.a,{"aria-label":"collapsible table",children:[Object(B.jsx)(G.a,{children:Object(B.jsxs)(P.a,{children:[Object(B.jsx)(D.a,{}),Object(B.jsx)(D.a,{children:"Username"}),Object(B.jsx)(D.a,{align:"right",children:"Blogs"})]})}),Object(B.jsx)(K.a,{children:e.rows.map((function(e){return Object(B.jsx)(_,{row:e},e.id)}))})]})})},te=function(){var e=Object(h.c)((function(e){return e.usersInfo}));return Object(B.jsxs)("div",{children:[Object(B.jsx)("h1",{children:"Users"}),Object(B.jsx)(ee,{rows:e})]})},ne=function(e){var t=Object(h.c)((function(e){return e.userLogged})),n=Object(h.b)(),r=Object(o.g)().id,c=e.blogs.find((function(e){return e.id===r}));if(!c)return null;var a=function(){var e=Object(b.a)(j.a.mark((function e(r,c){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Remove blog ".concat(c.title," by ").concat(c.author,"?")))try{n(z(r)),n(f("".concat(c.title," was deleted by ").concat(t.username))),setTimeout((function(){return n(f(""))}),3e3)}catch(a){n(f("missing or invalid token.")),setTimeout((function(){return n(f(""))}),3e3)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){var e=Object(b.a)(j.a.mark((function e(r,c){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n(N(r)),n(f("the blog ".concat(c.title," is liked by ").concat(t.username))),setTimeout((function(){n(f(""))}),3e3)}catch(a){n(f(a)),setTimeout((function(){return n(f(""))}),3e3)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s=function(e,r){console.log(e);try{n((c=e,a=r.id,function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.commentOnBlog(c,a);case 2:t({type:"blog/comment",comment:c,id:a});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),n(f("The use ".concat(t.username," has commented on the blog ").concat(r.title,": ").concat(e))),setTimeout((function(){return n(f(""),3e3)}))}catch(i){n(f(i)),setTimeout((function(){return n(f(""))}),3e3)}var c,a};return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{className:"detail-view",children:[c.title," by ",c.author," on ",Object(B.jsx)("a",{href:c.url,children:c.url})," likes ",c.likes,Object(B.jsx)("button",{value:"like",className:"like",onClick:function(){return i(c.id,c)},children:"like"}),Object(B.jsx)("button",{value:"delete",className:"delete",onClick:function(){return a(c.id,c)},children:"delete"}),Object(B.jsx)("p",{children:"Comments"}),Object(B.jsxs)("form",{onSubmit:function(e){s(e.target.comment.value,c)},children:[Object(B.jsx)("input",{type:"text",name:"comment"}),Object(B.jsx)("button",{typ:"submit",children:"Post"})]}),c.comments?c.comments.map((function(e){return Object(B.jsx)("li",{children:e},Object(L.a)())})):""]})})},re=function(e){var t=Object(o.g)().id,n=e.users.find((function(e){return e.id===t}));return n?Object(B.jsxs)("div",{children:[Object(B.jsx)("p",{children:n.username}),Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{children:"Added blogs"}),Object(B.jsx)("ul",{children:n.blogs.map((function(e){return Object(B.jsx)("li",{children:e.title},e.id)}))})]})]}):null},ce="/api/users",ae={getAll:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(ce);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat(ce,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/info":return t.users;default:return e}},se={display:"inline",padding:"5px"},oe=function(){return Object(B.jsx)("div",{children:"Welcome"})},ue=function(){var e=Object(h.c)((function(e){return e.notification})),t=Object(h.c)((function(e){return e.userLogged})),n=Object(h.c)((function(e){return e.blogs})),c=Object(h.c)((function(e){return e.usersInfo})),a=Object(o.f)(),i=Object(h.b)();Object(r.useEffect)((function(){k.getAll().then((function(e){return i((t=e,function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"blog/initialize",blogs:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var t})),ae.getAll().then((function(e){return i((t=e,function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"user/info",users:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var t}))}),[i]);return Object(B.jsx)("div",{children:t?Object(B.jsx)(u.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h3",{children:e}),Object(B.jsx)("div",{children:Object(B.jsx)("nav",{children:Object(B.jsxs)("ul",{children:[Object(B.jsx)("li",{style:se,children:Object(B.jsx)(s.b,{to:"/",children:"Home"})}),Object(B.jsx)("li",{style:se,children:Object(B.jsx)(s.b,{to:"/blog-list",children:"Blogs"})}),Object(B.jsx)("li",{style:se,children:Object(B.jsx)(s.b,{to:"/user-list",children:"Users"})}),Object(B.jsx)("li",{style:se,children:Object(B.jsx)(s.b,{to:"/post-blog",children:"Post"})}),t.username," logged in",Object(B.jsx)("li",{style:se,children:Object(B.jsx)("button",{onClick:function(){window.localStorage.removeItem("user"),window.localStorage.clear(),i(O("")),a.push("/login")},children:"Logout"})})]})})}),Object(B.jsxs)(o.c,{children:[Object(B.jsx)(o.a,{path:"/blog-list/:id",children:Object(B.jsx)(ne,{blogs:n})}),Object(B.jsx)(o.a,{path:"/user-list/:id",children:Object(B.jsx)(re,{users:c})}),Object(B.jsx)(o.a,{path:"/blog-list",children:Object(B.jsx)(J,{})}),Object(B.jsx)(o.a,{path:"/user-list",children:Object(B.jsx)(te,{})}),Object(B.jsx)(o.a,{path:"/post-blog",children:Object(B.jsx)(I,{})}),Object(B.jsx)(o.a,{path:"/login",children:Object(B.jsx)(A,{})}),Object(B.jsx)(o.a,{path:"/",children:Object(B.jsx)(oe,{})})]})]})}):Object(B.jsxs)("div",{children:[Object(B.jsx)(o.a,{to:"/login",children:Object(B.jsx)(A,{})}),a.push("login")]})})},le=n(57),je=n(84),be=n(85),de=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"state/toggle":return!e;default:return e}},he=Object(le.b)({blogs:U,userLogged:x,notification:p,usersInfo:ie,visible:de}),fe=Object(le.c)(he,Object(je.composeWithDevTools)(Object(le.a)(be.a)));i.a.render(Object(B.jsx)(h.a,{store:fe,children:Object(B.jsx)(s.a,{children:Object(B.jsx)(ue,{})})}),document.getElementById("root"))}},[[131,1,2]]]);
//# sourceMappingURL=main.78b22287.chunk.js.map