(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{135:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(12),i=n.n(a),o=n(16),s=n(182),u=n(7),l=n.n(u),j=n(10),b=n(32),d=n(13),h=function(e,t){return function(){var n=Object(j.a)(l.a.mark((function n(r){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:setTimeout((function(){r({type:"bloglist/create-notification",notification:""})}),1e3*t),r({type:"bloglist/create-notification",notification:e});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"bloglist/create-notification":return t.notification;default:return e}},p=function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"userLogin/set",user:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"userLogin/set":return t.user;default:return e}},x=n(25),g=n.n(x),m={login:function(){var e=Object(j.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=n(183),w=n(169),y=n(2),k=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(b.a)(a,2),s=i[0],u=i[1],f=Object(d.b)(),O=Object(o.f)(),x=function(){var e=Object(j.a)(l.a.mark((function e(t){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r={username:n,password:s},e.prev=2,e.next=5,m.login(r);case 5:a=e.sent,f(p(a)),window.localStorage.setItem("loggedUserJSON",JSON.stringify(a)),f(h("".concat(a.username," has logged in"),3)),O.push("/"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0),f(h("invalid username or password",3));case 16:c(""),u("");case 18:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{children:[Object(y.jsx)("h2",{children:"Login"}),Object(y.jsxs)("form",{onSubmit:x,children:[Object(y.jsx)(v.a,{required:!0,label:"Username",variant:"filled",size:"small",id:"getUsername",onChange:function(e){var t=e.target;return c(t.value)}}),Object(y.jsx)("br",{}),Object(y.jsx)(v.a,{required:!0,label:"Password",variant:"filled",size:"small",type:"password",id:"getPassword",onChange:function(e){var t=e.target;return u(t.value)}}),Object(y.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",id:"submitForm",children:"Submit"})]})]})},S="/api/blogs",N=null,B={getAll:function(){return g.a.get(S).then((function(e){return e.data}))},create:function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,g.a.post(S,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){N="bearer ".concat(e)},likeBlog:function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=6;break}return n={headers:{Authorization:N}},e.next=4,g.a.put("".concat(S,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=6;break}return n={headers:{Authorization:N}},e.next=4,g.a.delete("".concat(S,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),commentOnBlog:function(){var e=Object(j.a)(l.a.mark((function e(t,n){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("comment"),!N){e.next=8;break}return r={headers:{Authorization:N,"Access-Control-Allow-Origin":"*"}},e.next=5,g()({method:"put",url:"".concat(S,"/").concat(n,"/comments"),headers:r,data:{comment:t}});case 5:return c=e.sent,console.log(c),e.abrupt("return",c.data);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.create(e);case 2:n({type:"blog/create",blog:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},C=function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.likeBlog(e);case 2:n({type:"blog/like",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.deleteBlog(e);case 2:n({type:"blog/remove",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"blog/create":return e.concat(t.blog);case"blog/initialize":return t.blogs;case"blog/like":return e.map((function(e){return t.id===e.id&&(e.likes+=1),e}));case"blog/remove":return e.filter((function(e){return e.id!==t.id}));case"blog/comment":return e.map((function(e){return t.id===e.id&&e.comments.concat(t.comment),e}));default:return e}},T=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(b.a)(a,2),s=i[0],u=i[1],f=Object(r.useState)(""),p=Object(b.a)(f,2),O=p[0],x=p[1],g=Object(d.c)((function(e){return e.userLogged})),m=Object(d.b)(),k=Object(o.f)(),S=function(){return!g},N=function(){var e=Object(j.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{m(A(r={title:n,author:O,url:s,details:!1})),m(h("a new blog ".concat(r.title," by ").concat(r.author),3)),c(""),x(""),u(""),k.push("/blog-list")}catch(a){m(h(a,3))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{children:Object(y.jsxs)("form",{onSubmit:N,onClick:function(){return g?"":m(h("You cannot publish anything unless you are logged in. Please, sign up or log in to be able to publish",5))},children:[Object(y.jsx)(v.a,{required:!0,disabled:S(),variant:"filled",label:"Title",className:"title",value:n,onChange:function(e){var t=e.target;c(t.value)}}),Object(y.jsx)("br",{}),Object(y.jsx)(v.a,{required:!0,disabled:S(),variant:"filled",label:"Author",className:"author",value:O,onChange:function(e){var t=e.target;x(t.value)}}),Object(y.jsx)("br",{}),Object(y.jsx)(v.a,{required:!0,disabled:S(),variant:"filled",label:"Link",className:"url",value:s,onChange:function(e){var t=e.target;u(t.value)}}),Object(y.jsx)("br",{}),Object(y.jsx)(w.a,{disabled:S(),type:"submit",variant:"contained",color:"primary",size:"small",children:"Publish"})]})})},U=n(19),I=n(58),J=function(){var e=Object(d.c)((function(e){return e.blogs}));return Object(y.jsx)("div",{children:Object(y.jsxs)("div",{children:[Object(y.jsx)("h2",{children:"blogs"}),console.log(e),e.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(y.jsx)("li",{className:"blog",children:Object(y.jsx)(U.b,{to:"blog-list/".concat(e.id),children:e.title})},Object(I.a)())}))]})})},P=n(170),q=n(171),D=n(172),E=n(173),R=n(174),F=n(184),G=n(175),W=n(176),H=n(177),M=n(178),Y=n(179),K=n(137),Q=n(87),V=n.n(Q),X=n(86),Z=n.n(X),$=Object(P.a)({root:{"& > *":{borderBottom:"unset"}}}),_=function(e){var t=e.row,n=Object(r.useState)(!1),a=Object(b.a)(n,2),i=a[0],o=a[1],s=$();return Object(y.jsxs)(c.a.Fragment,{children:[Object(y.jsxs)(q.a,{className:s.root,children:[Object(y.jsx)(D.a,{children:Object(y.jsx)(E.a,{"aria-label":"expand row",size:"small",onClick:function(){return o(!i)},children:i?Object(y.jsx)(Z.a,{}):Object(y.jsx)(V.a,{})})}),Object(y.jsx)(D.a,{component:"th",scope:"row",children:Object(y.jsx)(U.b,{to:"/user-list/".concat(t.id),children:t.username})}),Object(y.jsx)(D.a,{align:"right",children:t.blogs.length})]}),Object(y.jsx)(q.a,{children:Object(y.jsx)(D.a,{styel:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(y.jsx)(R.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(y.jsxs)(F.a,{margin:1,children:[Object(y.jsx)(G.a,{variant:"h6",gutterBottom:!0,component:"div",children:"Blogs"}),Object(y.jsxs)(W.a,{size:"small","aria-label":"purchases",children:[Object(y.jsx)(H.a,{children:Object(y.jsxs)(q.a,{children:[Object(y.jsx)(D.a,{children:"Title"}),Object(y.jsx)(D.a,{align:"right",children:"Author"}),Object(y.jsx)(D.a,{align:"right",children:"Url"})]})}),Object(y.jsx)(M.a,{children:t.blogs.map((function(e){return Object(y.jsxs)(q.a,{children:[Object(y.jsx)(D.a,{component:"th",scope:"row",children:e.title}),Object(y.jsx)(D.a,{align:"right",children:e.author}),Object(y.jsx)(D.a,{align:"right",children:e.url})]},e.id)}))})]})]})})})})]})},ee=function(e){return Object(y.jsx)(Y.a,{component:K.a,children:Object(y.jsxs)(W.a,{"aria-label":"collapsible table",children:[Object(y.jsx)(H.a,{children:Object(y.jsxs)(q.a,{children:[Object(y.jsx)(D.a,{}),Object(y.jsx)(D.a,{children:"Username"}),Object(y.jsx)(D.a,{align:"right",children:"Blogs"})]})}),Object(y.jsx)(M.a,{children:e.rows.map((function(e){return Object(y.jsx)(_,{row:e},e.id)}))})]})})},te=function(){var e=Object(d.c)((function(e){return e.usersInfo}));return Object(y.jsxs)("div",{children:[Object(y.jsx)("h1",{children:"Users"}),Object(y.jsx)(ee,{rows:e})]})},ne=function(e){var t=Object(d.c)((function(e){return e.userLogged})),n=Object(d.b)(),r=Object(o.g)().id,c=e.blogs.find((function(e){return e.id===r}));if(!c)return null;var a=function(){var e=Object(j.a)(l.a.mark((function e(r,c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Remove blog ".concat(c.title," by ").concat(c.author,"?")))try{n(z(r)),n(h("".concat(c.title," was deleted by ").concat(t.username),3))}catch(a){n(h("missing or invalid token.",3))}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){var e=Object(j.a)(l.a.mark((function e(r,c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n(C(r)),n(h("the blog ".concat(c.title," is liked by ").concat(t.username),3))}catch(a){n(h(a,3))}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s=function(e,r){console.log(e);try{n((c=e,a=r.id,function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.commentOnBlog(c,a);case 2:t({type:"blog/comment",comment:c,id:a});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),n(h("The use ".concat(t.username," has commented on the blog ").concat(r.title,": ").concat(e),3))}catch(i){n(h(i,3))}var c,a};return Object(y.jsx)("div",{children:Object(y.jsxs)("div",{className:"detail-view",children:[c.title," by ",c.author," on ",Object(y.jsx)("a",{href:c.url,children:c.url})," likes ",c.likes,Object(y.jsx)("button",{value:"like",className:"like",onClick:function(){return i(c.id,c)},children:"like"}),Object(y.jsx)("button",{value:"delete",className:"delete",onClick:function(){return a(c.id,c)},children:"delete"}),Object(y.jsx)("p",{children:"Comments"}),Object(y.jsxs)("form",{onSubmit:function(e){s(e.target.comment.value,c)},children:[Object(y.jsx)("input",{type:"text",name:"comment"}),Object(y.jsx)("button",{typ:"submit",children:"Post"})]}),c.comments?c.comments.map((function(e){return Object(y.jsx)("li",{children:e},Object(I.a)())})):""]})})},re=function(e){var t=Object(o.g)().id,n=e.users.find((function(e){return e.id===t}));return n?Object(y.jsxs)("div",{children:[Object(y.jsx)("p",{children:n.username}),Object(y.jsxs)("div",{children:[Object(y.jsx)("h2",{children:"Added blogs"}),Object(y.jsx)("ul",{children:n.blogs.map((function(e){return Object(y.jsx)("li",{children:e.title},e.id)}))})]})]}):null},ce=function(){return Object(y.jsx)("div",{children:"Welcome"})},ae=n(185),ie=function(){var e=Object(d.c)((function(e){return e.notification}));return Object(y.jsx)("div",{children:e?Object(y.jsx)(ae.a,{severity:"info",children:e}):""})},oe=n(64),se=n(180),ue=n(181),le={textDecoration:"none"},je=Object(P.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),be=function(){var e=je(),t=Object(d.c)((function(e){return e.userLogged})),n=Object(d.b)(),r=Object(o.f)();return Object(y.jsx)("div",{className:e.root,children:Object(y.jsx)(se.a,{position:"static",children:Object(y.jsxs)(ue.a,{variant:"dense",children:[Object(y.jsx)(E.a,{edge:"start",color:"inherit","aria-label":"menu"}),Object(y.jsx)(w.a,{color:"inherit",component:U.b,style:le,to:"/",children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Home"})}),Object(y.jsx)(w.a,{color:"inherit",component:U.b,style:le,to:"/blog-list",children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Blogs"})}),Object(y.jsx)(w.a,{color:"inherit",component:U.b,style:le,to:"/user-list",children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Users"})}),Object(y.jsx)(w.a,{color:"inherit",component:U.b,style:le,to:"/post-blog",children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Publish"})}),t?Object(y.jsxs)("div",{style:{display:"inline",align:"left"},children:["".concat(t.username," logged in"),Object(y.jsx)(w.a,{color:"inherit",onClick:function(){window.localStorage.removeItem("user"),window.localStorage.clear(),n(p("")),r.push("/login")},children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Logout"})})]}):Object(y.jsx)(w.a,{color:"inherit",style:Object(oe.a)(Object(oe.a)({},le),{},{align:"left"}),component:U.b,to:"/login",children:Object(y.jsx)(G.a,{variant:"h6",className:e.title,children:"Login"})})]})})})},de="/api/users",he={getAll:function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get(de);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(j.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(de,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/info":return t.users;default:return e}},pe=function(){var e=Object(d.c)((function(e){return e.blogs})),t=Object(d.c)((function(e){return e.usersInfo})),n=Object(d.b)();return Object(r.useEffect)((function(){var e=!0,t=window.localStorage.getItem("loggedUserJSON");if(e&&t){var r=JSON.parse(t);n(p(r)),B.setToken(r.token)}return function(){e=!1}}),[n]),Object(r.useEffect)((function(){B.getAll().then((function(e){return n((t=e,function(){var e=Object(j.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"blog/initialize",blogs:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var t})),he.getAll().then((function(e){return n((t=e,function(){var e=Object(j.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"user/info",users:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var t}))}),[n]),Object(y.jsxs)("div",{children:[Object(y.jsx)(ie,{}),Object(y.jsx)(s.a,{children:Object(y.jsxs)("div",{children:[Object(y.jsx)(be,{}),Object(y.jsxs)(o.c,{children:[Object(y.jsx)(o.a,{path:"/login",children:Object(y.jsx)(k,{})}),Object(y.jsx)(o.a,{path:"/blog-list/:id",children:Object(y.jsx)(ne,{blogs:e})}),Object(y.jsx)(o.a,{path:"/user-list/:id",children:Object(y.jsx)(re,{users:t})}),Object(y.jsx)(o.a,{path:"/blog-list",children:Object(y.jsx)(J,{})}),Object(y.jsx)(o.a,{path:"/user-list",children:Object(y.jsx)(te,{})}),Object(y.jsx)(o.a,{path:"/post-blog",children:Object(y.jsx)(T,{})}),Object(y.jsx)(o.a,{path:"/",children:Object(y.jsx)(ce,{})})]})]})})]})},Oe=n(49),xe=n(88),ge=n(89),me=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"state/toggle":return!e;default:return e}},ve=Object(Oe.combineReducers)({blogs:L,userLogged:O,notification:f,usersInfo:fe,visible:me}),we=Object(Oe.createStore)(ve,Object(xe.composeWithDevTools)(Object(Oe.applyMiddleware)(ge.a)));i.a.render(Object(y.jsx)(d.a,{store:we,children:Object(y.jsx)(U.a,{children:Object(y.jsx)(pe,{})})}),document.getElementById("root"))}},[[135,1,2]]]);
//# sourceMappingURL=main.32fd926b.chunk.js.map