(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{67:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(17),i=n.n(a),s=n(14),u=n(5),o=n(2),l=n.n(o),b=n(3),j=n(12),f=n(6),d=function(e){return function(){var t=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"bloglist/create-notification",notification:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"bloglist/create-notification":return t.notification;default:return e}},p=function(e){return function(){var t=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"userLogin/set",user:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"userLogin/set":return t.user;default:return e}},v=n(13),g=n.n(v),x={login:function(){var e=Object(b.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},m="/api/blogs",w=null,y={getAll:function(){return g.a.get(m).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,g.a.post(m,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){w="bearer ".concat(e)},likeBlog:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=6;break}return n={headers:{Authorization:w}},e.next=4,g.a.put("".concat(m,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=6;break}return n={headers:{Authorization:w}},e.next=4,g.a.delete("".concat(m,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=n(1),N=function(e){var t=e.onLogin,n=Object(r.useState)(""),c=Object(j.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)(""),u=Object(j.a)(s,2),o=u[0],h=u[1],O=Object(f.b)();Object(r.useEffect)((function(){var e=!0,t=window.localStorage.getItem("loggedUserJSON");if(e&&t){var n=JSON.parse(t);O(p(n)),y.setToken(n.token)}return function(){e=!1}}),[]);var v=function(){var e=Object(b.a)(l.a.mark((function e(n){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r={username:a,password:o},e.prev=2,t(r),e.next=6,x.login(r);case 6:return c=e.sent,console.log(c),O(p(c)),window.localStorage.setItem("loggedUserJSON",JSON.stringify(c)),e.abrupt("return",c);case 13:e.prev=13,e.t0=e.catch(2),console.log(e.t0),O(d("invalid username or password")),setTimeout((function(){O(d(""))}),3e3);case 18:i(""),h("");case 20:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsx)("div",{children:Object(k.jsxs)("form",{onSubmit:v,children:["username ",Object(k.jsx)("input",{type:"text",className:"username",name:"username",id:"getUsername",value:a,onChange:function(e){var t=e.target;return i(t.value)}}),Object(k.jsx)("br",{}),"password ",Object(k.jsx)("input",{type:"text",className:"password",name:"password",id:"getPassword",value:o,onChange:function(e){var t=e.target;return h(t.value)}}),Object(k.jsx)("input",{type:"submit",name:"submit",id:"submitForm",value:"Submit"})]})})},C=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(j.a)(n,2),a=c[0],i=c[1],s=function(){i(!a)};return Object(r.useImperativeHandle)(t,(function(){return{handleCreateBlogClick:s}})),Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{style:{display:a?"None":""},children:Object(k.jsx)("input",{className:e.btnLabel,type:"button",value:e.btnLabel,onClick:s})}),Object(k.jsxs)("div",{style:{display:a?"":"None"},className:"show-child",children:[e.children,Object(k.jsx)("input",{type:"button",value:"cancel",onClick:s})]})]})}));C.displayName="Toggable";var S=C,L=function(e){return function(){var t=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.create(e);case 2:n({type:"blog/create",blog:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},B=function(e){return function(){var t=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.likeBlog(e);case 2:n({type:"blog/like",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.deleteBlog(e);case 2:n({type:"blog/remove",id:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"blog/create":return e.concat(t.blog);case"blog/initialize":return t.blogs;case"blog/like":return e.map((function(e){return t.id===e.id&&(e.likes+=1),e}));case"blog/remove":return e.filter((function(e){return e.id!==t.id}));default:return e}},I=function(e){var t=e.onBlogPost,n=Object(r.useState)(""),c=Object(j.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)(""),u=Object(j.a)(s,2),o=u[0],h=u[1],p=Object(r.useState)(""),O=Object(j.a)(p,2),v=O[0],g=O[1],x=Object(f.b)(),m=function(){var e=Object(b.a)(l.a.mark((function e(n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault();try{t(),x(L(r={title:a,author:v,url:o,details:!1})),x(d("a new blog ".concat(r.title," by ").concat(r.author))),setTimeout((function(){x(d(""))}),3e3),i(""),g(""),h("")}catch(c){x(d(c)),setTimeout((function(){x(d(""))}),3e3)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:["Create new",Object(k.jsxs)("form",{onSubmit:m,children:["title ",Object(k.jsx)("input",{className:"title",value:a,onChange:function(e){var t=e.target;i(t.value)}}),Object(k.jsx)("br",{}),"author ",Object(k.jsx)("input",{className:"author",value:v,onChange:function(e){var t=e.target;g(t.value)}}),Object(k.jsx)("br",{}),"url ",Object(k.jsx)("input",{className:"url",value:o,onChange:function(e){var t=e.target;h(t.value)}}),Object(k.jsx)("br",{}),Object(k.jsx)("input",{type:"submit",value:"create"})]})]})},J=function(e){var t=e.blog,n=Object(r.useState)(!1),c=Object(j.a)(n,2),a=c[0],i=c[1],s=Object(f.b)(),u=Object(f.c)((function(e){return e.userLogged})),o=function(){i(!a)},h=function(){var e=Object(b.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Remove blog ".concat(n.title," by ").concat(n.author,"?")))try{s(T(t)),s(d("".concat(n.title," was deleted by ").concat(u.username))),setTimeout((function(){return s(d(""))}),3e3)}catch(r){s(d("missing or invalid token.")),setTimeout((function(){return s(d(""))}),3e3)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=Object(b.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s(B(t)),s(d("the blog ".concat(n.title," is liked by ").concat(u.username))),setTimeout((function(){s(d(""))}),3e3)}catch(r){s(d(r)),setTimeout((function(){return s(d(""))}),3e3)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(k.jsx)("div",{children:a?Object(k.jsxs)("div",{className:"detail-view",children:[t.title," by ",t.author," on ",t.url," likes ",t.likes,Object(k.jsx)("button",{value:"like",className:"like",onClick:function(){return p(t.id,t)},children:"like"}),Object(k.jsx)("button",{value:"delete",className:"delete",onClick:function(){return h(t.id,t)},children:"delete"}),Object(k.jsx)("button",{value:"hide",className:"hide",onClick:o,children:"hide"})]}):Object(k.jsxs)("div",{className:"short-view",children:[t.title," by ",t.author,Object(k.jsx)("button",{value:"view",className:"view",onClick:o,children:"view"})]})})},z=function(){var e=Object(f.c)((function(e){return e.blogs})),t=Object(f.b)();return Object(r.useEffect)((function(){y.getAll().then((function(e){return t((n=e,function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"blog/initialize",blogs:n});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var n}))}),[]),Object(k.jsxs)("div",{children:[Object(k.jsx)("h2",{children:"blogs"}),e.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(k.jsx)(J,{blog:e},e.id)}))]})},U="api/users",E={getAll:function(){var e=Object(b.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get(U);case 2:return t=e.sent,console.log(t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(b.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(U,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/info":return t.users;default:return e}},R=function(e){var t=e.user;return Object(k.jsx)("div",{children:Object(k.jsx)("table",{children:Object(k.jsxs)("tbody",{children:[Object(k.jsxs)("tr",{children:[Object(k.jsx)("th",{}),Object(k.jsx)("th",{children:"Blogs"})]}),Object(k.jsxs)("tr",{children:[Object(k.jsx)("td",{children:t.username}),Object(k.jsx)("td",{children:t.blogs.length})]})]})})})},D=function(){var e=Object(f.c)((function(e){return e.usersInfo})),t=Object(f.b)();return Object(r.useEffect)((function(){E.getAll().then((function(e){return t((n=e,function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"user/info",users:n});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var n}))}),[]),Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"Users"}),Object(k.jsx)("div",{children:e.map((function(e){return Object(k.jsx)(R,{user:e},e.id)}))})]})},H=function(){var e=Object(f.b)();return Object(k.jsx)("div",{children:Object(k.jsx)("input",{type:"button",className:"logout",value:"logout",onClick:function(){window.localStorage.removeItem("user"),window.localStorage.clear(),e(p(""))}})})};function W(){return Object(k.jsx)("div",{children:"Welcome"})}var F=function(){var e=Object(f.c)((function(e){return e.notification})),t=Object(f.c)((function(e){return e.userLogged})),n=Object(r.useRef)(),c=Object(r.useRef)();return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:e}),t?Object(k.jsxs)(s.a,{children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)("p",{children:[t.username," logged in"]}),Object(k.jsx)("nav",{children:Object(k.jsxs)("ul",{children:[Object(k.jsx)("li",{children:Object(k.jsx)(s.b,{to:"/",children:"Home"})}),Object(k.jsx)("li",{children:Object(k.jsx)(s.b,{to:"blog-list",children:"Blogs"})}),Object(k.jsx)("li",{children:Object(k.jsx)(s.b,{to:"user-list",children:"Users"})}),Object(k.jsx)("li",{children:Object(k.jsx)(s.b,{to:"post-blog",children:"Post"})}),Object(k.jsx)("li",{children:Object(k.jsx)(s.b,{to:"logout",children:"Logout"})})]})})]}),Object(k.jsxs)(u.c,{children:[Object(k.jsx)(u.a,{path:"blog-list",children:Object(k.jsx)(z,{})}),Object(k.jsx)(u.a,{path:"user-list",children:Object(k.jsx)(D,{})}),Object(k.jsx)(u.a,{path:"post-blog",children:Object(k.jsx)(S,{btnLabel:"create-blog",ref:c,children:Object(k.jsx)(I,{onBlogPost:function(){c.current.handleCreateBlogClick()}})})}),Object(k.jsx)(u.a,{path:"user-list",children:Object(k.jsx)(H,{})}),Object(k.jsx)(u.a,{path:"user-list",children:Object(k.jsx)(W,{})})]})]}):Object(k.jsxs)("div",{children:[Object(k.jsx)("h2",{children:"Login"}),Object(k.jsx)(S,{btnLabel:"log-in",ref:n,children:Object(k.jsx)(N,{onLogin:function(){n.current.handleCreateBlogClick()}})})]})]})},q=n(18),G=n(32),K=n(33),M=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"state/toggle":return!e;default:return e}},Q=Object(q.b)({blogs:A,userLogged:O,notification:h,usersInfo:P,visible:M}),V=Object(q.c)(Q,Object(G.composeWithDevTools)(Object(q.a)(K.a)));i.a.render(Object(k.jsx)(f.a,{store:V,children:Object(k.jsx)(F,{})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.56ad4441.chunk.js.map