(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(16),u=n.n(c),o=n(2),s=n.n(o),i=n(3),l=n(4),b=n(0),j=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],c=n[1],u=function(){var t=Object(i.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onLikeBlog(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[a?Object(b.jsxs)("div",{children:[e.blog.title," on ",e.blog.url," by ",e.blog.author,Object(b.jsxs)("button",{onClick:function(){return u(e.blog.id)},children:["likes ",e.blog.likes]})]}):"".concat(e.blog.title," by ").concat(e.blog.author),Object(b.jsx)("input",{type:"button",value:a?"hide":"view",onClick:function(){c(!a)}})]})},p=a.a.forwardRef((function(e,t){var n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],u=a[1],o=Object(r.useState)(""),j=Object(l.a)(o,2),p=j[0],f=j[1],v=function(){var t=Object(i.a)(s.a.mark((function t(n){var r,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={username:c,password:p},t.next=4,e.onLogin(r);case 4:a=t.sent,e.onChangeUser(a),window.localStorage.setItem("loggedUserJSON",JSON.stringify(a)),e.onChangeErrorMessage(),u(""),f("");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Login"}),Object(b.jsxs)("form",{onSubmit:v,children:["username ",Object(b.jsx)("input",{type:"text",name:"username",id:"getUsername",value:c,onChange:function(e){var t=e.target;return u(t.value)}}),Object(b.jsx)("br",{})," password ",Object(b.jsx)("input",{type:"text",name:"password",id:"getPassword",value:p,onChange:function(e){var t=e.target;return f(t.value)}}),Object(b.jsx)("input",{type:"submit",name:"submit",id:"submitForm",value:"Submit"})]})]})})),f=function(e){return Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:[e.user.username," logged in"]}),Object(b.jsx)("input",{type:"button",value:"logout",onClick:function(){window.localStorage.removeItem("user"),window.localStorage.clear(),e.onChangeUser("")}})]})},v=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(l.a)(n,2),c=a[0],u=a[1],o=function(e){u(!c)};return Object(r.useImperativeHandle)(t,(function(){return{handleCreateBlogClick:o}})),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{display:c?"none":""},children:Object(b.jsx)("input",{type:"button",value:e.btnLabel,onClick:o})}),Object(b.jsxs)("div",{style:{display:c?"":"none"},children:[e.children,Object(b.jsx)("input",{type:"button",value:"cancel",onClick:o})]})]})})),O=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)(""),o=Object(l.a)(u,2),j=o[0],p=o[1],f=Object(r.useState)(""),v=Object(l.a)(f,2),O=v[0],d=v[1],g=function(){var t=Object(i.a)(s.a.mark((function t(n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={title:a,author:O,url:j},t.next=4,e.onPostBlog(r);case 4:c(""),d(""),p(""),e.onChangeErrorMessage("a new blog ".concat(r.title," by ").concat(r.author)),setTimeout((function(){e.onChangeErrorMessage("")}),3e3);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:["Create new",Object(b.jsxs)("form",{onSubmit:g,children:["title ",Object(b.jsx)("input",{value:a,onChange:function(e){var t=e.target;c(t.value)}}),Object(b.jsx)("br",{}),"author ",Object(b.jsx)("input",{value:O,onChange:function(e){var t=e.target;d(t.value)}}),Object(b.jsx)("br",{}),"url ",Object(b.jsx)("input",{value:j,onChange:function(e){var t=e.target;p(t.value)}}),Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"submit",value:"create"})]})]})},d=n(6),g=n.n(d),h="/api/blogs",x=null,m={getAll:function(){return g.a.get(h).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,g.a.post(h,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){x="bearer ".concat(e)},like:function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put("baseUrl/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w={login:function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=n(17),y=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),u=Object(l.a)(c,2),o=u[0],d=u[1],g=Object(r.useState)(""),h=Object(l.a)(g,2),x=h[0],y=h[1],C=Object(r.useRef)(),S=Object(r.useRef)();Object(r.useEffect)((function(){m.getAll().then((function(e){return a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUserJSON");if(e){var t=JSON.parse(e);y(t),m.setToken(t.token)}}),[]);var B=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.create(t);case 3:return n=e.sent,C.current.handleCreateBlogClick(),e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),d(e.t0),setTimeout((function(){d("")}),3e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.login(t);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),d("invalid username or password"),console.log(e.t0),setTimeout((function(){d("")}),3e3);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.like(t);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),d("invalid request: no blog found to like"),console.log(e.t0),setTimeout((function(){d("")}),3e3);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:o}),x?Object(b.jsxs)("div",{children:[Object(b.jsx)(f,{user:x,onChangeUser:y}),Object(b.jsx)(v,{btnLabel:"create new blog",ref:C,children:Object(b.jsx)(O,{onChangeErrorMessage:d,onChangeBlogs:a,onPostBlog:B})}),Object(b.jsx)("h2",{children:"blogs"}),n.map((function(e){return Object(b.jsx)(j,{blog:e,onLikeBlog:L},Object(k.a)())}))]}):Object(b.jsx)(v,{btnLabel:"login",ref:S,children:Object(b.jsx)(p,{onLogin:E,onChangeErrorMessage:d,onChangeUser:y})})]})})};u.a.render(Object(b.jsx)(y,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.5131b9ba.chunk.js.map